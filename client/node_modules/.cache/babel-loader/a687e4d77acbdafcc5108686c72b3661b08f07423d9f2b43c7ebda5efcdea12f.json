{"ast":null,"code":"import _toConsumableArray from\"/Users/aarushisingh/Projects/counter-offer/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/aarushisingh/Projects/counter-offer/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import Video from'twilio-video';import Participant from'./Participant';import Button from'react-bootstrap/Button';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Container from'react-bootstrap/Container';import Alert from'react-bootstrap/Alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Room=function Room(_ref){var roomName=_ref.roomName,token=_ref.token,handleLogout=_ref.handleLogout;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),participants=_useState4[0],setParticipants=_useState4[1];useEffect(function(){var participantConnected=function participantConnected(participant){setParticipants(function(prevParticipants){return[].concat(_toConsumableArray(prevParticipants),[participant]);});};var participantDisconnected=function participantDisconnected(participant){setParticipants(function(prevParticipants){return prevParticipants.filter(function(p){return p!==participant;});});};Video.connect(token,{name:roomName}).then(function(room){setRoom(room);room.on('participantConnected',participantConnected);room.on('participantDisconnected',participantDisconnected);room.participants.forEach(participantConnected);});return function(){setRoom(function(currentRoom){if(currentRoom&&currentRoom.localParticipant.state==='connected'){currentRoom.localParticipant.tracks.forEach(function(trackPublication){trackPublication.track.stop();});currentRoom.disconnect();return null;}else{return currentRoom;}});};},[roomName,token]);var remoteParticipants=participants.length>0?participants.map(function(participant){return/*#__PURE__*/_jsx(Participant,{participant:participant},participant.sid);})[participants.map(function(participant){return/*#__PURE__*/_jsx(Participant,{participant:participant},participant.sid);}).length-1]:/*#__PURE__*/_jsx(_Fragment,{});return/*#__PURE__*/_jsxs(\"div\",{className:\"room\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Alert,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Game Code\"}),\": \",roomName]}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"div\",{className:\"local-participant\",children:room?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Me\"}),/*#__PURE__*/_jsx(Participant,{participant:room.localParticipant},room.localParticipant.sid)]}):''})}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Counterpart\"}),/*#__PURE__*/_jsx(\"div\",{className:\"remote-participants\",children:remoteParticipants})]})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:handleLogout,children:\"Exit video call\"})]});};export default Room;","map":{"version":3,"names":["React","useState","useEffect","Video","Participant","Button","Row","Col","Container","Alert","Room","roomName","token","handleLogout","room","setRoom","participants","setParticipants","participantConnected","participant","prevParticipants","participantDisconnected","filter","p","connect","name","then","on","forEach","currentRoom","localParticipant","state","tracks","trackPublication","track","stop","disconnect","remoteParticipants","length","map","sid"],"sources":["/Users/aarushisingh/Projects/counter-offer/client/src/components/Room.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Video from 'twilio-video';\nimport Participant from './Participant';\nimport Button from 'react-bootstrap/Button'\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Container from 'react-bootstrap/Container'\nimport Alert from 'react-bootstrap/Alert'\n\nconst Room = ({ roomName, token, handleLogout }) => {\n  const [room, setRoom] = useState(null);\n  const [participants, setParticipants] = useState([]);\n\n  useEffect(() => {\n    const participantConnected = participant => {\n      setParticipants(prevParticipants => [...prevParticipants, participant]);\n    };\n\n    const participantDisconnected = participant => {\n      setParticipants(prevParticipants =>\n        prevParticipants.filter(p => p !== participant)\n      );\n    };\n\n    Video.connect(token, {\n      name: roomName\n    }).then(room => {\n      setRoom(room);\n      room.on('participantConnected', participantConnected);\n      room.on('participantDisconnected', participantDisconnected);\n      room.participants.forEach(participantConnected);\n    });\n\n    return () => {\n      setRoom(currentRoom => {\n        if (currentRoom && currentRoom.localParticipant.state === 'connected') {\n          currentRoom.localParticipant.tracks.forEach(function(trackPublication) {\n            trackPublication.track.stop();\n          });\n          currentRoom.disconnect();\n          return null;\n        } else {\n          return currentRoom;\n        }\n      });\n    };\n  }, [roomName, token]);\n\n  const remoteParticipants = participants.length > 0 ? \n    participants.map(participant => (\n    <Participant key={participant.sid} participant={participant} /> ))[participants.map(participant => (\n      <Participant key={participant.sid} participant={participant} /> )).length - 1]\n  :\n  <></>\n\n\n  return (\n    <div className=\"room\">\n      <br/>\n      <Alert><b>Game Code</b>: {roomName}</Alert>\n      <Container>\n        <Row>\n          <Col>\n            <div className=\"local-participant\">\n              {room ? (\n                <>\n                      <br/>\n                <h3>Me</h3>\n                <Participant\n                  key={room.localParticipant.sid}\n                  participant={room.localParticipant}\n                />\n                </>\n              ) : (\n                ''\n              )}\n            </div>\n          </Col>\n          <Col>\n            <br/>\n            <h3>Counterpart</h3>\n            <div className=\"remote-participants\">{remoteParticipants}</div>\n          </Col>\n        </Row>\n      </Container>\n\n      <br/>\n      <Button variant=\"danger\" onClick={handleLogout}>Exit video call</Button>\n\n      {/* <h3>Remote Participants</h3> */}\n    </div>\n  );\n};\n\nexport default Room;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}