{"ast":null,"code":"import _toConsumableArray from\"/Users/aarushisingh/Projects/counter-offer/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/aarushisingh/Projects/counter-offer/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Participant=function Participant(_ref){var participant=_ref.participant;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),videoTracks=_useState2[0],setVideoTracks=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),audioTracks=_useState4[0],setAudioTracks=_useState4[1];var videoRef=useRef();var audioRef=useRef();var trackpubsToTracks=function trackpubsToTracks(trackMap){return Array.from(trackMap.values()).map(function(publication){return publication.track;}).filter(function(track){return track!==null;});};useEffect(function(){setVideoTracks(trackpubsToTracks(participant.videoTracks));setAudioTracks(trackpubsToTracks(participant.audioTracks));var trackSubscribed=function trackSubscribed(track){if(track.kind===\"video\"){setVideoTracks(function(videoTracks){return[].concat(_toConsumableArray(videoTracks),[track]);});}else if(track.kind===\"audio\"){setAudioTracks(function(audioTracks){return[].concat(_toConsumableArray(audioTracks),[track]);});}};var trackUnsubscribed=function trackUnsubscribed(track){if(track.kind===\"video\"){setVideoTracks(function(videoTracks){return videoTracks.filter(function(v){return v!==track;});});}else if(track.kind===\"audio\"){setAudioTracks(function(audioTracks){return audioTracks.filter(function(a){return a!==track;});});}};participant.on(\"trackSubscribed\",trackSubscribed);participant.on(\"trackUnsubscribed\",trackUnsubscribed);return function(){setVideoTracks([]);setAudioTracks([]);participant.removeAllListeners();};},[participant]);useEffect(function(){var videoTrack=videoTracks[0];if(videoTrack){videoTrack.attach(videoRef.current);return function(){videoTrack.detach();};}},[videoTracks]);useEffect(function(){var audioTrack=audioTracks[0];if(audioTrack){audioTrack.attach(audioRef.current);return function(){audioTrack.detach();};}},[audioTracks]);return/*#__PURE__*/_jsxs(\"div\",{className:\"participant\",children:[/*#__PURE__*/_jsx(\"video\",{style:{width:\"100%\"},ref:videoRef,autoPlay:true}),/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,autoPlay:true,muted:true})]});};export default Participant;","map":{"version":3,"names":["React","useState","useEffect","useRef","Participant","participant","videoTracks","setVideoTracks","audioTracks","setAudioTracks","videoRef","audioRef","trackpubsToTracks","trackMap","Array","from","values","map","publication","track","filter","trackSubscribed","kind","trackUnsubscribed","v","a","on","removeAllListeners","videoTrack","attach","current","detach","audioTrack","width"],"sources":["/Users/aarushisingh/Projects/counter-offer/client/src/components/Participant.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\n\nconst Participant = ({ participant }) => {\n  const [videoTracks, setVideoTracks] = useState([]);\n  const [audioTracks, setAudioTracks] = useState([]);\n\n  const videoRef = useRef();\n  const audioRef = useRef();\n\n  const trackpubsToTracks = (trackMap) =>\n    Array.from(trackMap.values())\n      .map((publication) => publication.track)\n      .filter((track) => track !== null);\n\n  useEffect(() => {\n    setVideoTracks(trackpubsToTracks(participant.videoTracks));\n    setAudioTracks(trackpubsToTracks(participant.audioTracks));\n\n    const trackSubscribed = (track) => {\n      if (track.kind === \"video\") {\n        setVideoTracks((videoTracks) => [...videoTracks, track]);\n      } else if (track.kind === \"audio\") {\n        setAudioTracks((audioTracks) => [...audioTracks, track]);\n      }\n    };\n\n    const trackUnsubscribed = (track) => {\n      if (track.kind === \"video\") {\n        setVideoTracks((videoTracks) => videoTracks.filter((v) => v !== track));\n      } else if (track.kind === \"audio\") {\n        setAudioTracks((audioTracks) => audioTracks.filter((a) => a !== track));\n      }\n    };\n\n    participant.on(\"trackSubscribed\", trackSubscribed);\n    participant.on(\"trackUnsubscribed\", trackUnsubscribed);\n\n    return () => {\n      setVideoTracks([]);\n      setAudioTracks([]);\n      participant.removeAllListeners();\n    };\n  }, [participant]);\n\n  useEffect(() => {\n    const videoTrack = videoTracks[0];\n    if (videoTrack) {\n      videoTrack.attach(videoRef.current);\n      return () => {\n        videoTrack.detach();\n      };\n    }\n  }, [videoTracks]);\n\n  useEffect(() => {\n    const audioTrack = audioTracks[0];\n    if (audioTrack) {\n      audioTrack.attach(audioRef.current);\n      return () => {\n        audioTrack.detach();\n      };\n    }\n  }, [audioTracks]);\n\n  return (\n    <div className=\"participant\">\n      {/* <h4>{participant.identity}</h4> */}\n      <video style={{width:\"100%\"}} ref={videoRef} autoPlay={true} />\n      <audio ref={audioRef} autoPlay={true} muted={true} />\n    </div>\n  );\n};\n\nexport default Participant;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}